<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <script>
        // list to tree
        // const listToTree = function (list) {

        // }

        let list = [
            { id: 1, name: '部门A', parentId: 0 },
            { id: 2, name: '部门B', parentId: 0 },
            { id: 3, name: '部门C', parentId: 1 },
            { id: 4, name: '部门D', parentId: 1 },
            { id: 5, name: '部门E', parentId: 2 },
            { id: 6, name: '部门F', parentId: 3 },
            { id: 7, name: '部门G', parentId: 2 },
            { id: 8, name: '部门H', parentId: 4 }
        ];

        // let tree = [
        //     {
        //         id: 1,
        //         name: '部门A',
        //         parentId: 0,
        //         children: [
        //             { id: 1, name: '部门A', parentId: 0 },
        //             { id: 2, name: '部门B', parentId: 0 },
        //         ]
        //     },
        //     {
        //         id: 2,
        //         name: '部门B',
        //         parentId: 0,
        //         children: [
        //         ]
        //     }
        // ];

        function listToTree(list) {
            let res = [], currObj = null, flag = false
            function getParent(childrenList, item) {
                let isHas = false
                childrenList.forEach(child => {
                    if (child.id == item.parentId) {
                        currObj = child
                        isHas = true
                    } else {
                        if (Array.isArray(child.children)) {
                            getParent(child.children, item)
                        } else {
                            isHas = false
                        }
                    }
                });
            }
            if (!res.length) {
                res.push({
                    ...list[0], children: []
                })
            }
            for (let i = 1; i < list.length; i++) {
                const listItem = list[i];
                getParent(res, listItem)
                if (isHas) {
                    currObj.children.push(listItem)
                } else {
                    currObj = {...listItem, children: []}
                }
            }
            return res
        }


        console.log(listToTree(list))


    </script>
</body>

</html>