<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>es6-proxy</title>
</head>
<body>
    <script>
        // const obj = new Proxy({}, {
        //     get: function (target, propKey, receiver) {
        //         console.log(`getting ${propKey}!`);
        //         return Reflect.get(target, propKey, receiver);
        //     },
        //     set: function (target, propKey, value, receiver) {
        //         console.log(`setting ${propKey}!`);
        //         return Reflect.set(target, propKey, value, receiver);
        //     }
        // })

        // obj.count = 1
        // ++obj.count

        // const obj = new Proxy({}, {
        //     get: function (target, propKey, receiver) {
        //         return 35
        //     }
        // })
        // console.log(obj.name)
        // console.log(obj.age)
        // console.log(obj.time)

        // https://www.ghosind.com/2019/04/13/js-proxy
        // var target = {};
        // var handler = {};
        // var proxy = new Proxy(target, handler);
        // proxy.a = 'b';
        // console.log('target.a', target.a)
        // console.log(target === proxy)


        // var proxy = new Proxy({}, {
        //     get: function(target, propKey) {
        //         console.log(propKey)
        //         return 35;
        //     }
        // });
        // let obj = Object.create(proxy);
        // console.log(obj.time) // 35

        // var handler = {
        //     get: function(target, name) {
        //         if (name === 'prototype') {
        //             return Object.prototype;
        //         }
        //         return 'Hello, ' + name;
        //     },
        //     apply: function(target, thisBinding, args) {
        //         // console.log('target', target)
        //         // console.log('thisBinding', thisBinding)
        //         // console.log('args', args)
        //         return args[0];
        //     },
        //     construct: function(target, args) {
        //         return {value: args[1]};
        //     }
        // };
        // var fproxy = new Proxy(function(x, y) {
        //     return x + y;
        // }, handler);
        // console.log(typeof fproxy)  // function
        // console.log(fproxy(1, 2)) // 1
        // console.log(new fproxy(1, 2)) // {value: 2}
        // console.log(fproxy.prototype === Object.prototype) // true
        // console.log(fproxy.foo === "Hello, foo") // true

        // var person = { name: "张三" };

        // var proxy = new Proxy(person, {
        //     get: function(target, propKey) {
        //         if (propKey in target) {
        //             return target[propKey];
        //         } else {
        //             throw new ReferenceError("Prop name \"" + propKey + "\" does not exist.");
        //         }
        //     }
        // });

        // console.log(proxy.name) // "张三"
        // console.log(proxy.age) // 抛出一个错误  


        // let proto = new Proxy({}, {
        //     get(target, propertyKey, receiver) {
        //         console.log('GET ' + propertyKey);
        //         return target[propertyKey];
        //     }
        // });

        // let obj = Object.create(proto);
        // console.log(obj.foo) // "GET foo" // undefine
        
        // 可以把多个参数存为一个数组
        function createArray(...elements) {
            console.log('elements', elements)
            // elements == [...arguments]
            let handler = {
                get(target, propKey, receiver) {
                    let index = Number(propKey);
                    if (index < 0) {
                        propKey = String(target.length + index);
                    }
                    return Reflect.get(target, propKey, receiver);
                }
            };

            let target = [];
            target.push(...elements);
            return new Proxy(target, handler);
        }

        let arr = createArray('a', 'b', 'c');
        console.log(arr[-1]) // c










    </script>
</body>
</html>