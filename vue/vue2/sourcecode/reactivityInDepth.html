<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ·±å…¥å“åº”å¼åŸç† | Jayconscious</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/blog/assets/img/favicon.ico">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~ae3b4e4a.f9171a56.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~7181f674.3697a4b4.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~786cfedb.acd4a80b.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~e97ebc98.42d9c0ce.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~ec4c70c1.e021af99.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~92e9d224.33fb4913.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~1a2f86b4.e6c74f10.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~7860dd99.fedac3b0.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~a72e7967.c6bcdcdc.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~a90c22bc.6003747e.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~929f0a25.6185d8e1.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~c27f1b1d.eeaaa8c6.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~cdd1d9fd.b6dbaca7.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~0bcc290c.7cf29f1a.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~d6eb103f.a32d965a.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~5c078696.477401ce.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~f1a1cd68.6753eb79.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~defc7f12.ee85afea.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~54aeb72e.fa37be6c.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/18.styles.8387c6b4.css" as="style"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~d0ae3f07.8387c6b4.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/15.styles.6b900697.css" as="style"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~b5906859.6b900697.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~ec8c427e.e5ca240a.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/25.styles.146757e2.css" as="style"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~fdc6512a.146757e2.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/5.styles.149ee583.css" as="style"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~6a2c4da6.149ee583.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~205977d4.41d1d324.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~7dcdd765.06c066b0.js" as="script"><link rel="preload" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/app.bde9cf47.js" as="script">
    <link rel="stylesheet" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/18.styles.8387c6b4.css"><link rel="stylesheet" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/15.styles.6b900697.css"><link rel="stylesheet" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/25.styles.146757e2.css"><link rel="stylesheet" href="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/css/5.styles.149ee583.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-7dd95ae2><div data-v-7dd95ae2><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>Jayconscious</h3> <p class="description" data-v-59e6cb88>Just playing around</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>jayconscious</span>
        Â Â 
        <span data-v-59e6cb88>2020 - </span>
        2024
      </a></span></div></div> <div class="hide" data-v-7dd95ae2><header class="navbar" data-v-7dd95ae2><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">Jayconscious</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/Javascript/" class="nav-link"><i class="undefined"></i>
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/algorithm/" class="nav-link"><i class="undefined"></i>
  algorithm
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Engineering/" class="nav-link"><i class="undefined"></i>
  Engineering
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/asyncProgramming/" class="nav-link"><i class="undefined"></i>
  asyncProgramming
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Node.js/" class="nav-link"><i class="undefined"></i>
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/other/" class="nav-link"><i class="undefined"></i>
  other
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/protocol/" class="nav-link"><i class="undefined"></i>
  protocol
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Vue2.x/" class="nav-link"><i class="undefined"></i>
  Vue2.x
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Vuex/" class="nav-link"><i class="undefined"></i>
  Vuex
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/jayconscious" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-7dd95ae2></div> <aside class="sidebar" data-v-7dd95ae2><div class="personal-info-wrapper" data-v-1fad0c41 data-v-7dd95ae2><img src="/blog/assets/img/avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    jayconscious
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>72</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>11</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/categories/Javascript/" class="nav-link"><i class="undefined"></i>
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/algorithm/" class="nav-link"><i class="undefined"></i>
  algorithm
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Engineering/" class="nav-link"><i class="undefined"></i>
  Engineering
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/asyncProgramming/" class="nav-link"><i class="undefined"></i>
  asyncProgramming
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Node.js/" class="nav-link"><i class="undefined"></i>
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/other/" class="nav-link"><i class="undefined"></i>
  other
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/protocol/" class="nav-link"><i class="undefined"></i>
  protocol
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Vue2.x/" class="nav-link"><i class="undefined"></i>
  Vue2.x
</a></li><li class="dropdown-item"><!----> <a href="/blog/categories/Vuex/" class="nav-link"><i class="undefined"></i>
  Vuex
</a></li></ul></div></div><div class="nav-item"><a href="/blog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="https://github.com/jayconscious" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/blog/vue/vue2/sourcecode/templateEngine" class="sidebar-heading clickable open"><span>æºç åˆ†æ</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue2/sourcecode/templateEngine.html" class="sidebar-link">Vue æ¨¡æ¿è§£æ</a></li><li><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html" aria-current="page" class="active sidebar-link">æ·±å…¥å“åº”å¼åŸç†</a></li><li><a href="/blog/vue/vue2/sourcecode/vueDiff.html" class="sidebar-link">virtual DOM &amp;&amp; Diff</a></li><li><a href="/blog/vue/vue2/sourcecode/asyncRender.html" class="sidebar-link">å¼‚æ­¥æ¸²æŸ“</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/blog/vue/vue2/question/dataIsFn" class="sidebar-heading clickable"><span>é—®é¢˜è§£ç­”</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/vue/vue2/question/dataIsFn.html" class="sidebar-link">vueç»„ä»¶é‡Œçš„dataä¸ºä»€ä¹ˆæ˜¯å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡</a></li><li><a href="/blog/vue/vue2/question/checkDupKeys.html" class="sidebar-link">ä¸ºä»€ä¹ˆåˆ—è¡¨ç»„ä»¶ä¸ç”¨ index ä½œä¸º key</a></li><li><a href="/blog/vue/vue2/question/aboutNextTick.html" class="sidebar-link">æ€ä¹ˆç†è§£Vueä¸­çš„$nextTick</a></li><li><a href="/blog/vue/vue2/question/directive.html" class="sidebar-link">vue ä¸­å¦‚ä½•è‡ªå®šä¹‰æŒ‡ä»¤åŠå…¶åŸç†</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-7dd95ae2><h3 class="title" data-v-59e6cb88>æ·±å…¥å“åº”å¼åŸç†</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>jayconscious</span>
        Â Â 
        <span data-v-59e6cb88>2020 - </span>
        2024
      </a></span></div></div> <div data-v-7dd95ae2><div data-v-7dd95ae2><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">æ·±å…¥å“åº”å¼åŸç†</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>jayconscious</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2/25/2021</span></i> <i class="iconfont reco-eye" data-v-8a445198><span id="/blog/vue/vue2/sourcecode/reactivityInDepth.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-8a445198><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>Vue</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="ä»€ä¹ˆæ˜¯æ•°æ®å“åº”å¼"><a href="#ä»€ä¹ˆæ˜¯æ•°æ®å“åº”å¼" class="header-anchor">#</a> ä»€ä¹ˆæ˜¯æ•°æ®å“åº”å¼</h2> <p>åœ¨ä¸Šå¤(jq)æ—¶ä»£ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦æ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å€ŸåŠ©DOMæ“ä½œ(jq)å’Œæ¨¡æ¿å¼•æ“(underscoreâ€¦)ï¼Œç»“åˆæ•°æ®æ¥å®Œæˆï¼Œéå¸¸çš„ç¹çã€‚æœ‰äº† vue çš„ä¹‹åï¼Œå€ŸåŠ©æ•°æ®å“åº”å¼ç³»ç»Ÿï¼Œåªéœ€è¦ &lt;div v-for=â€œitem in listâ€&gt; å°±å¯ä»¥å®Œæˆã€‚è¿™ä¸ªç®€å•çš„demo, ä½“ç°äº† Vue.js ä¸€ä¸ªæ ¸å¿ƒæ€æƒ³å°±æ˜¯æ•°æ®é©±åŠ¨ã€‚æ‰€è°“æ•°æ®é©±åŠ¨ï¼Œæ˜¯æŒ‡è§†å›¾æ˜¯ç”±æ•°æ®é©±åŠ¨ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬å¯¹è§†å›¾çš„ä¿®æ”¹ï¼Œä¸ä¼šç›´æ¥æ“ä½œ DOMï¼Œè€Œæ˜¯é€šè¿‡ä¿®æ”¹æ•°æ®ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ï¼Œæ·±å…¥æºç åˆ†æè¿™ä¸€éƒ¨åˆ†ã€‚è¿™ä¸ªè¿‡ç¨‹å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†<code>è®©æ•°æ®å˜æˆå“åº”å¼</code>ã€<code>ä¾èµ–æ”¶é›†</code> å’Œ <code>æ´¾å‘æ›´æ–°</code>ã€‚</p> <h2 id="æ•°æ®å“åº”å¼æ•´ä½“åŸç†"><a href="#æ•°æ®å“åº”å¼æ•´ä½“åŸç†" class="header-anchor">#</a> æ•°æ®å“åº”å¼æ•´ä½“åŸç†</h2> <p>è¿™é‡Œæˆ‘ä»¬å€ŸåŠ©å®˜ç½‘çš„ä¸€å¼ å›¾ï¼Œå¦‚ä¸‹å›¾ï¼š</p> <p><img src="/assets/img/vue2/reactivity/reactivity.png" alt="image"></p> <p>åœ¨æ¸²æŸ“æ—¶ï¼Œ<code>vm._update()</code>æ–¹æ³•é‡æ–°æ¸²æŸ“ï¼Œè¿™ä¸ªä¼š <code>touch</code> åˆ°æ¨¡æ¿ä¸­çš„æ•°æ®ï¼Œä¼šå‘å“åº”æ•°æ®çš„ <code>get</code> å‡½æ•°ï¼Œæ”¶é›†æœ¬æ¬¡æ¸²æŸ“çš„ä¾èµ–ã€‚æ”¶é›†ä¾èµ–å’Œæ›´æ–°æ´¾å‘éƒ½æ˜¯åŸºäº <code>Watcher</code> è§‚å¯Ÿè€…ã€‚åœ¨æˆ‘ä»¬ç»™æŸäº›æ•°æ®è¿›è¡Œå¤åˆ¶æ“ä½œæ—¶ï¼Œä¼šè§¦å‘å“åº”æ•°æ®çš„ <code>set</code> å‡½æ•°ï¼Œ<code>set</code> ä¼šè°ƒç”¨ <code>dep.notify()</code>ï¼Œé€šçŸ¥ä¾èµ–å®ƒçš„ <code>watcher</code>, è§¦å‘è¯•å›¾æ›´æ–°ã€‚</p> <p>æ€»ä¹‹æ•°æ®é©±åŠ¨çš„æ ¸å¿ƒï¼Œå°±æ˜¯é€šè¿‡ <code>Object.defineProperty</code> æ–¹æ³•å»é‡å†™æ•°æ®çš„<code>get</code>å’Œ<code>set</code>å±æ€§æè¿°ç¬¦ï¼Œ<strong>è®©æ•°æ®åœ¨è¢«æ¸²æŸ“æ—¶æŠŠæ‰€æœ‰ç”¨åˆ°è‡ªå·±çš„è®¢é˜…è€…å­˜æ”¾åœ¨è‡ªå·±çš„è®¢é˜…è€…åˆ—è¡¨ä¸­ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶å°†è¯¥å˜åŒ–é€šçŸ¥åˆ°æ‰€æœ‰è®¢é˜…äº†è‡ªå·±çš„è®¢é˜…è€…</strong>ï¼Œè¾¾åˆ°é‡æ–°æ¸²æŸ“çš„ç›®çš„ã€‚</p> <h2 id="è®©æ•°æ®å˜æˆå“åº”å¼"><a href="#è®©æ•°æ®å˜æˆå“åº”å¼" class="header-anchor">#</a> è®©æ•°æ®å˜æˆå“åº”å¼</h2> <p>Vue çš„æ•°æ®å“åº”å¼åŸç†æ˜¯ <code>ES5</code> å†…ç½®å¯¹è±¡æ–¹æ³• <code>Object.defineProperty</code>(ä¸€äº›æµè§ˆå™¨ä¸Šä¸æ”¯æŒçš„ï¼ŒIE8: å¤§å®¶éƒ½çœ‹æˆ‘å¹²å—ï¼Ÿ) æ¥å®ç°çš„ã€‚<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty" target="_blank" rel="noopener noreferrer">è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ã€‚<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œåœ¨æ–°çš„vue3å½“å‰æ˜¯ä½¿ç”¨äº† <code>ES6</code> çš„ <code>Proxy</code>ä»£æ›¿äº†å®ƒã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç†æ¸…æ•´ä¸ªå“åº”å¼çš„åˆå§‹åŒ–é“¾è·¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p> <p><img src="/assets/img/vue2/reactivity/defineProperty.png" alt="image"></p> <h3 id="vueçš„åˆå§‹åŒ–"><a href="#vueçš„åˆå§‹åŒ–" class="header-anchor">#</a> Vueçš„åˆå§‹åŒ–</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Vue</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Vue</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Vue is a constructor and should be called with the `new` keyword'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">initMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">stateMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">eventsMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lifecycleMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">renderMixin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ä¸Šè¿°çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>new Vue</code> æ—¶ï¼Œå®é™…ä¸Šè°ƒç”¨äº† <code>this._init(options)</code> è¿™ä¸ªæ–¹æ³•ï¼Œ<code>_init</code> è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ <code>initMixin(Vue)</code>æ—¶ï¼Œæ·»åŠ åˆ° <code>Vue.prototype</code> ä¸Šçš„ã€‚<code>_init</code> ä¸­æœ‰è°ƒç”¨äº†ä¸€å †åˆå§‹åŒ–çš„æ–¹æ³•ï¼Œå…³äºå“åº”å¼çš„ä¸»è¦æ˜¯åœ¨ <code>initState</code> ä¸­ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vm<span class="token punctuation">.</span>_watchers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> opts <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">initProps</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>methods<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">initMethods</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>methods<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">initData</span><span class="token punctuation">(</span>vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">observe</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* asRootData */</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">initComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>computed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>watch <span class="token operator">&amp;&amp;</span> opts<span class="token punctuation">.</span>watch <span class="token operator">!==</span> nativeWatch<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">initWatch</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>watch<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="å°†options-data-å˜ä¸ºå“åº”å¼"><a href="#å°†options-data-å˜ä¸ºå“åº”å¼" class="header-anchor">#</a> å°†options.data å˜ä¸ºå“åº”å¼</h2> <p>åœ¨ä¸Šè¿°çš„ <code>initState</code> æ–¹æ³•ä¸­ï¼Œä¸»è¦æ˜¯å¯¹ <code>props</code>ï¼Œ<code>methods</code>ï¼Œ<code>data</code>ï¼Œ<code>computed</code>ï¼Œ<code>watch</code>è¿›è¡Œäº†ç›¸å…³åˆå§‹åŒ–æ“ä½œï¼Œé™¤äº† <code>methods</code>ï¼Œå…¶ä»–éƒ½ä¼šå˜æˆå“åº”å¼ã€‚æˆ‘ä»¬ä¸»è¦çœ‹ä¸€ä¸‹ <code>initData</code> åšäº†å“ªäº›äº‹æƒ…ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">initData</span><span class="token punctuation">(</span><span class="token parameter">vm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> data <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    data <span class="token operator">=</span> vm<span class="token punctuation">.</span>_data <span class="token operator">=</span> <span class="token keyword">typeof</span> data <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span>
        <span class="token function">getData</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> vm<span class="token punctuation">)</span> <span class="token operator">:</span>
        data <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token function">warn</span><span class="token punctuation">(</span>
            <span class="token string">'data functions should return an object:\n'</span> <span class="token operator">+</span>
            <span class="token string">'https://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function'</span><span class="token punctuation">,</span>
            vm
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// proxy data on instance</span>
    <span class="token keyword">var</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> props <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>props<span class="token punctuation">;</span>
    <span class="token keyword">var</span> methods <span class="token operator">=</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>methods<span class="token punctuation">;</span>
    <span class="token keyword">var</span> i <span class="token operator">=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> key <span class="token operator">=</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>methods <span class="token operator">&amp;&amp;</span> <span class="token function">hasOwn</span><span class="token punctuation">(</span>methods<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">warn</span><span class="token punctuation">(</span>
                    <span class="token punctuation">(</span><span class="token string">&quot;Method \&quot;&quot;</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&quot;\&quot; has already been defined as a data property.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    vm
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>props <span class="token operator">&amp;&amp;</span> <span class="token function">hasOwn</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">warn</span><span class="token punctuation">(</span>
                <span class="token string">&quot;The data property \&quot;&quot;</span> <span class="token operator">+</span> key <span class="token operator">+</span> <span class="token string">&quot;\&quot; is already declared as a prop. &quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;Use prop default value instead.&quot;</span><span class="token punctuation">,</span>
                vm
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isReserved</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">proxy</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">&quot;_data&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// observe data</span>
    <span class="token function">observe</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* asRootData */</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>ä¸Šè¿°çš„ <code>initData</code> ä¸»è¦æ˜¯å¯¹ <code>$options.data</code> å¤„ç†ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªåŠŸèƒ½ï¼š</p> <ol><li><strong>å°† <code>data</code> æŒ‚è½½åˆ° <code>vm</code> ç¤ºä¾‹ä¸Š</strong>ï¼ŒåŒæ—¶æ£€æŸ¥ <code>data</code>ä¸­çš„ <code>key</code>æ˜¯å¦ä¸ <code>props</code> å’Œ <code>methods</code> ä¸­çš„ <code>key</code>æœ‰å†²çª</li> <li><code>observe(data, true)</code>ï¼Œä½¿ç”¨ <code>observe</code>æ–¹æ³•å°† <code>data</code> æˆä¸ºå“åº”å¼ã€‚</li></ol> <ul><li>æ£€æŸ¥ <code>data</code> å±æ€§æ˜¯å¦æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹äºç»„ä»¶æ¥è¯´</li> <li>éå†è¿‡ç¨‹å°†ä¼šä½¿ç”¨ <code>hasOwn(methods, key)</code>ã€<code>hasOwn(props, key)</code>ã€<code>!isReserved(key)</code> æ–¹æ³•å¯¹è¯¥æ•°æ®æ˜¯å¦å ç”¨ä¿ç•™å­—ã€æ˜¯å¦ä¸ <code>props</code> å’Œ <code>methods</code> ä¸­çš„å±æ€§é‡åè¿›è¡Œåˆ¤æ–­ï¼Œç„¶åè°ƒç”¨ <code>proxy</code> æ–¹æ³•å°†å…¶ä»£ç†åˆ° <code>Vue</code> å®ä¾‹ä¸Šã€‚</li></ul> <div class="custom-block tip"><p class="title"></p><p>å¦‚æœ data ä¸­çš„å±æ€§ä¸ propsã€methods ä¸­çš„å±æ€§é‡åï¼Œé‚£ä¹ˆåœ¨ Vue å®ä¾‹ä¸Šè°ƒç”¨è¿™ä¸ªå±æ€§æ—¶çš„ä¼˜å…ˆçº§é¡ºåºæ˜¯ props &gt; methods &gt; data</p></div><p>æœ€åå¯¹æ¯ä¸€ä¸ª data ä¸­çš„å±æ€§è°ƒç”¨ observe æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„åŠŸèƒ½æ˜¯èµ‹äºˆ data ä¸­çš„å±æ€§å¯è¢«ç›‘æµ‹çš„ç‰¹æ€§ã€‚observe æ–¹æ³•ä¸»è¦æ˜¯è°ƒç”¨ Observer ç±»æ„é€ æ–¹æ³•ï¼Œå°†æ¯ä¸€ä¸ª data ä¸­çš„ value å˜æˆå¯è§‚å¯Ÿã€å“åº”å¼çš„ï¼š</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> <span class="token keyword">var</span> <span class="token function-variable function">Observer</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Observer</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>vmCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">def</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">'__ob__'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>hasProto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">protoAugment</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> arrayMethods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">copyAugment</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> arrayMethods<span class="token punctuation">,</span> arrayKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>åˆå§‹åŒ– <code>Observer</code>ï¼Œæœ‰ä¸€ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p> <ul><li>é’ˆå¯¹å½“å‰çš„æ•°æ®å¯¹è±¡æ–°å»ºä¸€ä¸ªè®¢é˜…å™¨ï¼›</li> <li>ä¸ºæ¯ä¸ªæ•°æ®çš„ <code>value</code> éƒ½æ·»åŠ ä¸€ä¸ª <code>__ob__</code> å±æ€§ï¼Œè¯¥å±æ€§ä¸å¯æšä¸¾å¹¶æŒ‡å‘è‡ªèº«ï¼›</li> <li>é’ˆå¯¹æ•°ç»„ç±»å‹çš„æ•°æ®è¿›è¡Œå•ç‹¬å¤„ç†ï¼ˆåŒ…æ‹¬èµ‹äºˆå…¶æ•°ç»„çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»¥åŠ <code>observeArray</code> è¿›è¡Œçš„æ•°ç»„ç±»å‹æ•°æ®çš„å“åº”å¼ï¼‰ï¼›</li> <li><code>this.walk(value)</code>ï¼Œéå†å¯¹è±¡çš„ <code>key</code> è°ƒç”¨ <code>defineReactive</code> æ–¹æ³•ï¼›</li></ul> <p><code>defineReactive</code> æ˜¯çœŸæ­£ä¸ºæ•°æ®æ·»åŠ  <code>get</code> å’Œ <code>set</code> å±æ€§æ–¹æ³•çš„æ–¹æ³•ï¼Œå®ƒå°† <code>data</code> ä¸­çš„æ•°æ®å®šä¹‰ä¸€ä¸ªå“åº”å¼å¯¹è±¡ï¼Œå¹¶ç»™è¯¥å¯¹è±¡è®¾ç½® <code>get</code> å’Œ <code>set</code> å±æ€§æ–¹æ³•ï¼Œå…¶ä¸­ <code>get</code> æ–¹æ³•æ˜¯å¯¹ä¾èµ–è¿›è¡Œæ”¶é›†ï¼Œ <code>set</code> æ–¹æ³•æ˜¯å½“æ•°æ®æ”¹å˜æ—¶é€šçŸ¥ <code>Watcher</code> æ´¾å‘æ›´æ–°ã€‚</p> <h2 id="ä¾èµ–æ”¶é›†"><a href="#ä¾èµ–æ”¶é›†" class="header-anchor">#</a> ä¾èµ–æ”¶é›†</h2> <p>ä¸ºä»€ä¹ˆè¦åšä¾èµ–æ”¶é›†ï¼Œå› ä¸ºä¸çŸ¥é“æ˜¯ä¸æ˜¯æ‰€æœ‰å£°æ˜çš„æ•°æ®éƒ½ä¼šåœ¨é¡µé¢æ¸²æŸ“æ—¶ç”¨åˆ°ã€‚åŸºäºè¿™æ ·çš„åœºæ™¯ï¼Œæ‰€ä»¥åœ¨ <code>touch</code> é¡µé¢æ¸²æŸ“ä¼šè§¦å‘ç›¸å…³æ•°æ®çš„ <code>get</code> æ–¹æ³•ï¼Œé€šè¿‡ <code>get</code> æ–¹æ³•è¿›è¡Œä¾èµ–çš„æ”¶é›†ã€‚</p> <p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ <code>defineReactive$$1</code> ä¸­ï¼Œå¯¹ <code>value</code> çš„ <code>get</code>å±æ€§æè¿°ç¬¦æ˜¯å¦‚ä½•å®šä¹‰çš„ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reactiveGetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> getter <span class="token operator">?</span> <span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span> val<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>childOb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            childOb<span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">dependArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>åœ¨è§¦å‘ <code>get</code> å‡½æ•°æ—¶ï¼Œè°ƒç”¨äº† <code>dep.depend()</code>ï¼Œè¿™æ˜¯ä¾èµ–æ”¶é›†çš„è¿‡ç¨‹ï¼Œæˆ–è€…æ˜¯è¯´è®¢é˜…è€…æ·»åŠ ä¾èµ–è®¢é˜…ï¼Œæµç¨‹å¦‚ä¸‹å›¾ï¼š</p> <p><img src="/assets/img/vue2/reactivity/addDep.png" alt="image"></p> <p>é¦–å…ˆè¿™é‡Œæˆ‘ä»¬è¦ææ¸…æ¥šè°æ˜¯ä¾èµ–ï¼Œè°æ˜¯è®¢é˜…ï¼Œ<code>watcher</code>ç±» å°±æ˜¯ä¾èµ–ï¼Œå› ä¸ºå®ƒä¾èµ–äºæ•°æ®ï¼Œ<code>Dep</code>ç±»å°±æ˜¯è®¢é˜…ï¼Œä¼šå°†ä¾èµ–æ”¾åœ¨è‡ªå·±çš„è®¢é˜…è€…<code>subs</code>åˆ—è¡¨ä¸­ç®¡ç†ã€‚</p> <p>è¿™é‡Œæœ‰ç‚¹æŠ½è±¡ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸ªğŸŒ°ï¼š</p> <p>å‡å¦‚å½“å‰æ¸²æŸ“çš„ç»„ä»¶ <code>User</code> ,å®ƒçš„<code>template</code>æ¨¡æ¿ <code>name</code>,ä¾èµ–äº†è‡ªå·±çš„ <code>data</code> ä¸­çš„ <code>name</code>ã€‚<code>User</code>ç»„ä»¶æ¸²æŸ“ä¼šäº§ç”Ÿçš„ <code>watcher</code>, é€šè¿‡ <code>pushTarget</code> æ–¹æ³•ï¼Œèµ‹å€¼åœ¨ <code>Dep.target</code> ä¸Šï¼Œ ç”± <code>name</code>å®ä¾‹åŒ–çš„è®¢é˜…å™¨åœ¨è°ƒç”¨<code>dep.depend</code>ï¼Œå…¶å®è°ƒç”¨äº†  <code>watcher.addDep(dep) =&gt; dep.addSub(watcher)</code>ï¼Œåé¢è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ<code>name</code>è®¢é˜…å™¨å°† <code>User</code>ä¾èµ–(<code>watcher</code>)æ·»åŠ åˆ°äº†è‡ªå·±çš„è®¢é˜…è€…åˆ—è¡¨ä¸­ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¾èµ–æ”¶é›†çš„è¿‡ç¨‹äº†ã€‚</p> <h2 id="dep-è®¢é˜…å™¨"><a href="#dep-è®¢é˜…å™¨" class="header-anchor">#</a> Dep è®¢é˜…å™¨</h2> <p>ä¸Šé¢åªæ˜¯ç®€å•ä»‹ç»äº†<code>Dep</code> å‚ä¸äº†æ•°æ®ä¾èµ–çš„è¿‡ç¨‹ï¼Œå…·ä½“æ¥çœ‹çœ‹<code>Dep</code>ç±»æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Dep</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> uid<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Dep</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addSub</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">addSub</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Dep</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">removeSub</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">removeSub</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">,</span> sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Dep</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">depend</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Dep<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">addDep</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Dep</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">notify</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> subs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>config<span class="token punctuation">.</span>async<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        subs<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> a<span class="token punctuation">.</span>id <span class="token operator">-</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> subs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        subs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p><code>Dep</code>ç±»ä¸­ä¸»è¦ä¸ä¸‰ä¸ªå±æ€§ï¼š<code>id</code>ï¼Œ<code>subs</code>ï¼Œ<code>target</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºå½“å‰è®¢é˜…å™¨çš„æ ‡è¯†ï¼Œè®¢é˜…è€…åˆ—è¡¨ä»¥åŠå½“å‰çš„è®¢é˜…è€…ã€‚æ­¤å¤–è¿˜æä¾›ä¸€äº›æ·»åŠ ï¼Œåˆ é™¤ï¼Œé€šçŸ¥è®¢é˜…è€…çš„æ–¹æ³•ã€‚</p> <p>è¿™é‡Œé‡ç‚¹è¯´æ˜ä¸€ç‚¹ <code>Dep.target</code>ï¼ŒæŒ‡çš„æ˜¯å½“å‰å…¨å±€çš„å”¯ä¸€è®¢é˜…è€…ã€‚è¿™ä¸ªè®¢é˜…è€…æ˜¯æœ‰ä¸€ä¸ªè®¢é˜…è€…æ ˆ <code>targetStack</code>ï¼Œå½“æŸä¸€ä¸ªç»„ä»¶æ‰§è¡Œåˆ°æŸä¸ªç”Ÿå‘½å‘¨æœŸçš„ <code>hook</code> æ—¶ï¼ˆä¾‹å¦‚ mountComponentï¼‰ï¼Œä¼šå°†å½“å‰ç›®æ ‡è®¢é˜…è€… <code>target</code> ç½®ä¸ºè¿™ä¸ª <code>watcher</code>ï¼Œå¹¶å°†å…¶å‹å…¥ <code>targetStack</code> æ ˆé¡¶ã€‚</p> <p>æ‰€ä»¥è¿™é‡Œå¾ˆæ˜¾ç„¶ <code>Dep.target.addDep(this)</code> å°±æ˜¯ <code>watcher.addDep(dep)</code>ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>Watcher</code> ç±»ä¸­çš„è¿™ä¸ªæ–¹æ³•åšäº†å“ªäº›äº‹æƒ…ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Watcher</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">addDep</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">addDep</span><span class="token punctuation">(</span><span class="token parameter">dep</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> id <span class="token operator">=</span> dep<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>newDepIds<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>newDepIds<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>newDeps<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>dep<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>depIds<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            dep<span class="token punctuation">.</span><span class="token function">addSub</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><code>newDepIds</code> æ˜¯å½“å‰æ•°æ®ä¾èµ– <code>dep</code> çš„ <code>id</code> åˆ—è¡¨ï¼Œ<code>newDeps</code> æ˜¯å½“å‰æ•°æ®ä¾èµ– <code>dep</code> åˆ—è¡¨ï¼Œ<code>depsId</code> åˆ™æ˜¯ä¸Šä¸€ä¸ª <code>tick</code>(ç–‘é—®ï¼štickæ˜¯ä»€ä¹ˆï¼Œåé¢æˆ‘ä»¬ä¼šè§£é‡Šçš„) çš„æ•°æ®ä¾èµ–çš„ <code>id</code> åˆ—è¡¨ã€‚åœ¨è¿™é‡Œå¯ä»¥ç®€å•ç†è§£ä¸º <code>User</code>åˆæ·»åŠ å…¶ä»–çš„æ•°æ®ä¾èµ–ï¼Œæ¯”å¦‚ <code>family</code>ï¼Œæ‰€ä»¥ä¹‹å‰çš„æ•°æ®è®¢é˜…å’Œç°åœ¨çš„æ•°æ®è®¢é˜…ä¼šæœ‰æ‰€ä¸åŒï¼Œå¦‚æœä¹‹å‰æœ‰äº†å°±ä¸å¿…æ·»åŠ åˆ°è¿™ä¸ªæ•°æ®çš„è®¢é˜…è€…åˆ—è¡¨äº†ã€‚</p> <h2 id="watcher-target-ä½•æ—¶äº§ç”Ÿçš„"><a href="#watcher-target-ä½•æ—¶äº§ç”Ÿçš„" class="header-anchor">#</a> Watcher.target ä½•æ—¶äº§ç”Ÿçš„</h2> <p>ä¸Šè¿°çš„è¿‡ç¨‹æè¿°ä¸­æˆ‘ä»¬ä¸€å®šä¼šç–‘æƒ‘ <code>Watcher.target</code> æ˜¯ä½•æ—¶æŒ‚åœ¨çš„ã€‚è¿™é‡Œä¸»è¦æ¶‰åŠåˆ°äº† <code>mountComponent</code> è¿™ä¸ªæ–¹æ³•ã€‚ç»„ä»¶æŒ‚è½½æ—¶ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mountComponent</span><span class="token punctuation">(</span> <span class="token parameter">vm<span class="token punctuation">,</span> el<span class="token punctuation">,</span> hydrating</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    vm<span class="token punctuation">.</span>$el <span class="token operator">=</span> el<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>render<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
    <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeMount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> updateComponent<span class="token punctuation">;</span>
    <span class="token comment">/* istanbul ignore if */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>config<span class="token punctuation">.</span>performance <span class="token operator">&amp;&amp;</span> mark<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆæ¬¡æ¸²æŸ“ï¼Œç”Ÿæˆ vNode</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">updateComponent</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ›´æ–°æ¸²æŸ“</span>
            vm<span class="token punctuation">.</span><span class="token function">_update</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span><span class="token function">_render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> hydrating<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> updateComponent<span class="token punctuation">,</span> noop<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">before</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>_isMounted <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>vm<span class="token punctuation">.</span>_isDestroyed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">callHook</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> <span class="token string">'beforeUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span> <span class="token comment">/* isRenderWatcher */</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">return</span> vm
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><code>updateComponent</code> å‡½æ•°ä¼šè°ƒç”¨æ˜¯æ¸²æŸ“çœŸå®DOMçš„æ–¹æ³•ï¼Œæ‰€ä»¥åœ¨ç”Ÿå‘½å‘¨æœŸ<code>beforeMount</code>åè°ƒç”¨ã€‚åœ¨ <code>watcher</code>å®ä¾‹åŒ–æ—¶ï¼Œä¼šä¾æ®å…¥å‚<code>lazy</code>é»˜è®¤å€¼(é»˜è®¤å€¼æ˜¯ false)æ¥è°ƒç”¨ <code>this.get()</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Watcher</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Watcher</span><span class="token punctuation">(</span> <span class="token parameter">vm<span class="token punctuation">,</span> expOrFn<span class="token punctuation">,</span> cb<span class="token punctuation">,</span> options<span class="token punctuation">,</span> isRenderWatcher</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> vm<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isRenderWatcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        vm<span class="token punctuation">.</span>_watcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    vm<span class="token punctuation">.</span>_watchers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// options</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deep <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>deep<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>user<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lazy <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>lazy<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>sync<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>before <span class="token operator">=</span> options<span class="token punctuation">.</span>before<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deep <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lazy <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">=</span> cb<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token operator">++</span>uid$2<span class="token punctuation">;</span> <span class="token comment">// uid for batching</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>active <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lazy<span class="token punctuation">;</span> <span class="token comment">// for lazy watchers</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>deps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>newDeps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>depIds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">_Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>newDepIds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">_Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>expression <span class="token operator">=</span> expOrFn<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// parse expression for getter</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> expOrFn <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>getter <span class="token operator">=</span> expOrFn<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>getter <span class="token operator">=</span> <span class="token function">parsePath</span><span class="token punctuation">(</span>expOrFn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lazy <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Watcher</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">get</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">pushTarget</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> vm<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token comment">// &quot;touch&quot; every property so they are all tracked as</span>
        <span class="token comment">// dependencies for deep watching</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>deep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">traverse</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token function">popTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cleanupDeps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> targetStack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">pushTarget</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    targetStack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">popTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    targetStack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> targetStack<span class="token punctuation">[</span>targetStack<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p>è¿™é‡Œæœ‰ä¸€ä¸ªé—­åŒ…å˜é‡ <code>targetStack</code> æ¥å­˜å‚¨ <code>watcher</code>ï¼Œ<code>pushTarget</code>æŠŠå½“å‰çš„ <code>watcher</code> å‹å…¥ <code>targetStack</code> æ ˆä¸­ã€‚å¹¶ä¸”æŠŠå½“å‰çš„è®¢é˜…å™¨ <code>Dep.target</code> æŒ‡å‘å½“å‰çš„ <code>watcher</code>ã€‚æ­¤å¤–æˆ‘ä»¬çš„æ¸²æŸ“å‡½æ•°æŒ‚è½½åœ¨ <code>watcher.getter</code> ä¸Šï¼Œ<code>this.getter.call(vm, vm)</code> æ¸²æŸ“å®Œæˆä¹‹åï¼Œå½“å‰çš„ <code>watcher</code>ä¼šè¢«å¼¹å‡ºæ ˆï¼Œå¹¶ä¸”ä¼šæ¸…é™¤æ‰€æœ‰çš„è®¢é˜…å™¨ã€‚å› ä¸º <code>watcher</code>æ‰€ä¾èµ–çš„æ•°æ®ï¼Œæ˜¯ç”±æ¨¡æ¿å†³å®šçš„ï¼Œæ¨¡æ¿æ‰€è¦ä¾èµ–çš„æ•°æ®æ˜¯ç”±ç”¨æˆ·ç¼–å†™çš„é€»è¾‘å†³å®šçš„ï¼Œæ¯æ¬¡é‡æ–°æ¸²æŸ“çš„æ—¶å€™å†å»æ”¶é›†æ•°æ®ã€‚å¦‚æœåœ¨æ•°æ®çš„è®¢é˜…å™¨ä¸­å·²ç»æœ‰äº†å½“å‰çš„ <code>watcher</code> æ˜¯ä¸ä¼šæ·»åŠ åˆ°è‡ªå·±çš„ <code>subs</code> è®¢é˜…è€…åˆ—è¡¨ä¸­çš„ã€‚</p> <h2 id="æ´¾å‘æ›´æ–°"><a href="#æ´¾å‘æ›´æ–°" class="header-anchor">#</a> æ´¾å‘æ›´æ–°</h2> <p><img src="/assets/img/vue2/reactivity/dispatch.png" alt="image"></p> <p>å½“æ•°æ®æ›´æ–°æ—¶ï¼Œä¼šè§¦å‘æ•°æ®çš„ <code>set</code> å‡½æ•°ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ <code>set</code> æœ‰å“ªäº›é€»è¾‘ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">reactiveSetter</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> getter <span class="token operator">?</span> <span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">:</span> val<span class="token punctuation">;</span> <span class="token comment">// åŸå§‹å€¼</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>newVal <span class="token operator">===</span> value <span class="token operator">||</span> <span class="token punctuation">(</span>newVal <span class="token operator">!==</span> newVal <span class="token operator">&amp;&amp;</span> value <span class="token operator">!==</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>customSetter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">customSetter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>getter <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>setter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>setter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        val <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// å¦‚æœæ˜¯å¯¹è±¡</span>
    childOb <span class="token operator">=</span> <span class="token operator">!</span>shallow <span class="token operator">&amp;&amp;</span> <span class="token function">observe</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><ul><li>å¦‚æœåŸæ¥çš„æ•°æ®å­˜åœ¨ <code>getter</code>ï¼Œ<code>getter.call(obj)</code>è·å–åˆ°åŸå§‹å€¼ <code>value</code>ï¼Œæ»¡è¶³ <code>newVal === value</code>ï¼Œåˆ™è¡¨æ˜æ•°æ®æ²¡æœ‰å˜åŒ–ï¼Œç›´æ¥ <code>return</code>ã€‚</li> <li>å¦‚æœåŸæ¥çš„æ•°æ®å­˜åœ¨ <code>setter</code>ï¼Œ<code>setter.call(obj, newVal)</code>ï¼Œè°ƒç”¨åŸå€¼çš„ <code>stter</code>ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™å°† <code>newVal</code> èµ‹å€¼ç»™é—­åŒ…å˜é‡ <code>val</code>ï¼Œè§¦å‘ <code>get</code>ä¼šè¿”å›è¿™ä¸ªå€¼ã€‚</li> <li>æ´¾å‘æ›´æ–°ä¸»è¦æ˜¯è°ƒç”¨äº† <code>dep.notify()</code>,æˆ‘ä»¬æ¥çœ‹çœ‹è¿™éƒ¨åˆ†çš„å…·ä½“å®ç°ã€‚</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Dep</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">notify</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> subs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æµ…æ‹·è´æ•°ç»„</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>config<span class="token punctuation">.</span>async<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åŒæ­¥éœ€è¦æ’åº æœ‰å°åˆ°å¤§</span>
        subs<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> a<span class="token punctuation">.</span>id <span class="token operator">-</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> subs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        subs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">Watcher</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">update</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>lazy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>å¦‚æœæ˜¯ <code>config.async</code> åŒæ­¥çš„è¯ï¼Œéœ€è¦å°†è®¢é˜…è€…åˆ—è¡¨æ’åºï¼Œç„¶åä¾æ¬¡æ´¾å‘æ›´æ–°ï¼Œå³è°ƒç”¨ <code>watcher.update()</code>ã€‚å¦‚æœ <code>watcher</code> æ˜¯åŒæ­¥ï¼Œåˆ™è°ƒç”¨ <code>this.run();</code>,å°±æ˜¯åŒæ­¥æ›´æ–°è§†å›¾ã€‚
å¦‚æœ <code>watcher</code> å†…éƒ¨ <code>this.sync == false</code>ï¼Œè°ƒç”¨ <code>queueWatcher(this)</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token parameter">watcher</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flushing<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>watcher<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// if already flushing, splice the watcher based on its id</span>
            <span class="token comment">// å¦‚æœå·²ç»å†²æ´—ï¼Œåˆ™æ ¹æ®å…¶IDæ‹¼æ¥è§‚å¯Ÿè€…</span>
            <span class="token comment">// if already past its id, it will be run next immediately.</span>
            <span class="token comment">// å¦‚æœå·²ç»è¶…è¿‡å…¶IDï¼Œå®ƒå°†ç«‹å³ç«‹å³è¿è¡Œã€‚</span>
            <span class="token keyword">var</span> i <span class="token operator">=</span> queue<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> index <span class="token operator">&amp;&amp;</span> queue<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">&gt;</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                i<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            queue<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> watcher<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// queue the flush</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>waiting<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            waiting <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token comment">// åŒæ­¥</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>config<span class="token punctuation">.</span>async<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">flushSchedulerQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span>
            <span class="token punctuation">}</span>
            <span class="token function">nextTick</span><span class="token punctuation">(</span>flushSchedulerQueue<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>ä½¿ç”¨é—­åŒ…å˜é‡<code>has</code>æ¥åˆ¤æ–­ä¼ å…¥çš„<code>watcher</code>æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œä¸å­˜åœ¨çš„è¯ï¼Œæ ‡è¯†<code>has[id] = true</code>ï¼›å¦‚æœå½“å‰çš„ <code>queueWatcher</code>æ­£åœ¨ <code>flushing</code>ï¼Œåˆ¤æ–­å½“å‰çš„ <code>watcher</code>é˜Ÿåˆ—æ­£åœ¨æ‰§è¡Œçš„<code>watcher.id</code>å’Œè¿™ä¸ªæ¯”è¾ƒï¼Œå¦‚æœ<code>queue</code>ä¸­idå¤§äºå½“å‰çš„idï¼Œç«‹å³æ’å…¥ï¼›æ²¡æœ‰åˆ™æ’åˆ°åé¢ã€‚<code>config.async</code>å¼‚æ­¥çš„è¯ï¼Œå°±æ˜¯ç”¨ <code>nextTick</code> åˆ›å»ºä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œæ‰§è¡Œ <code>flushSchedulerQueue</code>ã€‚</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">flushSchedulerQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    currentFlushTimestamp <span class="token operator">=</span> <span class="token function">getNow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    flushing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> watcher<span class="token punctuation">,</span> id<span class="token punctuation">;</span>
    queue<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a<span class="token punctuation">.</span>id <span class="token operator">-</span> b<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// do not cache length because more watchers might be pushed</span>
    <span class="token comment">// as we run existing watchers</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> queue<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        watcher <span class="token operator">=</span> queue<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">.</span>before<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            watcher<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        id <span class="token operator">=</span> watcher<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        watcher<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// in dev build, check and stop circular updates.</span>
        <span class="token comment">// åœ¨å¼€å‘ç‰ˆæœ¬ä¸­ï¼Œæ£€æŸ¥å¹¶åœæ­¢å¾ªç¯æ›´æ–°ã€‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>has<span class="token punctuation">[</span>id<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// keep copies of post queues before resetting state</span>
    <span class="token keyword">var</span> activatedQueue <span class="token operator">=</span> activatedChildren<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// keep-alive ç»„ä»¶</span>
    <span class="token keyword">var</span> updatedQueue <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ™®é€šç»„ä»¶</span>
    <span class="token function">resetSchedulerState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// call component updated and activated hooks</span>
    <span class="token function">callActivatedHooks</span><span class="token punctuation">(</span>activatedQueue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">callUpdatedHooks</span><span class="token punctuation">(</span>updatedQueue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// devtool hook</span>
    <span class="token comment">/* istanbul ignore if */</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>devtools <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>devtools<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        devtools<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'flush'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>åœ¨ <code>flushSchedulerQueue</code>ä¸­ï¼Œå…ˆå°† <code>queue</code> ä¸­çš„ <code>watcher</code> ä»å°åˆ°å¤§æ’åºï¼Œç„¶åé‡ç½® <code>has[id] = null</code>ï¼Œå¾ªç¯æ‰§è¡Œ <code>watcher.run()</code>ã€‚åœ¨é‡ç½®æ¸…ç©ºä¹‹å‰ï¼Œè¦è€ƒå¤‡ä¸€ä»½å‘å¸ƒé˜Ÿåˆ—ã€‚ç„¶åè°ƒç”¨ <code>resetSchedulerState</code>ï¼Œé‡ç½®æ•´ä¸ªä»»åŠ¡é˜Ÿåˆ—çŠ¶æ€ã€‚ç„¶åè°ƒç”¨ <code>UpdatedHooks</code>ï¼Œé€šçŸ¥ç»„ä»¶å†…éƒ¨å·²ç»æ›´æ–°äº†ã€‚è‡³æ­¤æ•´ä¸ªå“åº”å¼çš„é€»è¾‘å·²èµ°å®Œæ•´äº†ã€‚å“...ï¼ŒçœŸçš„å¤š</p> <h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="header-anchor">#</a> æ€»ç»“</h2> <p>åˆ†ææºç ï¼Œä¸ä»…äº†è§£äº†æ•´ä¸ªæ¡†æ¶çš„è®¾è®¡ï¼Œè€Œä¸”å¯¹äºä½œè€…å¯¹ç»†èŠ‚çš„æŠŠæ¡ï¼Œæœ‰äº†æ·±åˆ»çš„è®¤çŸ¥ï¼Œå¯èƒ½ä¸èƒ½é¢é¢ä¿±åˆ°ï¼Œæœ‰äº›ç»†ææœ«èŠ‚çš„ä¸œè¥¿è¿˜æ²¡æœ‰ææ¸…æ¥šã€‚è¦çŸ¥é“æˆ‘ä»¬å¯¹äº‹ç‰©çš„è®¤çŸ¥æ˜¯èºæ—‹å¼ä¸Šå‡æ³¢æµªå¼å‰è¿›çš„ï¼Œå¤šå‡ æ¬¡çš„æ¥è§¦å°±ä¼šæœ‰æ›´å¤šæ–°çš„é¢†æ‚Ÿï¼Œåº”ç”¨ä¹Ÿæ›´åŠ çµæ´»ã€‚</p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°: </span> <span class="time">12/26/2024, 7:10:28 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/blog/vue/vue2/sourcecode/templateEngine.html" class="prev">
          Vue æ¨¡æ¿è§£æ
        </a></span> <span class="next"><a href="/blog/vue/vue2/sourcecode/vueDiff.html">
          virtual DOM &amp;&amp; Diff
        </a></span></p></div> <div class="comments-wrapper" style="display:none;"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-b57cc07c data-v-7dd95ae2><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#ä»€ä¹ˆæ˜¯æ•°æ®å“åº”å¼" class="sidebar-link reco-side-ä»€ä¹ˆæ˜¯æ•°æ®å“åº”å¼" data-v-b57cc07c>ä»€ä¹ˆæ˜¯æ•°æ®å“åº”å¼</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#æ•°æ®å“åº”å¼æ•´ä½“åŸç†" class="sidebar-link reco-side-æ•°æ®å“åº”å¼æ•´ä½“åŸç†" data-v-b57cc07c>æ•°æ®å“åº”å¼æ•´ä½“åŸç†</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#è®©æ•°æ®å˜æˆå“åº”å¼" class="sidebar-link reco-side-è®©æ•°æ®å˜æˆå“åº”å¼" data-v-b57cc07c>è®©æ•°æ®å˜æˆå“åº”å¼</a></li><li class="level-3" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#vueçš„åˆå§‹åŒ–" class="sidebar-link reco-side-vueçš„åˆå§‹åŒ–" data-v-b57cc07c>Vueçš„åˆå§‹åŒ–</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#å°†options-data-å˜ä¸ºå“åº”å¼" class="sidebar-link reco-side-å°†options-data-å˜ä¸ºå“åº”å¼" data-v-b57cc07c>å°†options.data å˜ä¸ºå“åº”å¼</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#ä¾èµ–æ”¶é›†" class="sidebar-link reco-side-ä¾èµ–æ”¶é›†" data-v-b57cc07c>ä¾èµ–æ”¶é›†</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#dep-è®¢é˜…å™¨" class="sidebar-link reco-side-dep-è®¢é˜…å™¨" data-v-b57cc07c>Dep è®¢é˜…å™¨</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#watcher-target-ä½•æ—¶äº§ç”Ÿçš„" class="sidebar-link reco-side-watcher-target-ä½•æ—¶äº§ç”Ÿçš„" data-v-b57cc07c>Watcher.target ä½•æ—¶äº§ç”Ÿçš„</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#æ´¾å‘æ›´æ–°" class="sidebar-link reco-side-æ´¾å‘æ›´æ–°" data-v-b57cc07c>æ´¾å‘æ›´æ–°</a></li><li class="level-2" data-v-b57cc07c><a href="/blog/vue/vue2/sourcecode/reactivityInDepth.html#æ€»ç»“" class="sidebar-link reco-side-æ€»ç»“" data-v-b57cc07c>æ€»ç»“</a></li></ul></div></div></div><div class="global-ui"><!----><!----></div></div>
    <script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~ae3b4e4a.f9171a56.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~7181f674.3697a4b4.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~786cfedb.acd4a80b.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~e97ebc98.42d9c0ce.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~ec4c70c1.e021af99.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~92e9d224.33fb4913.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~1a2f86b4.e6c74f10.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~7860dd99.fedac3b0.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~a72e7967.c6bcdcdc.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~a90c22bc.6003747e.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~929f0a25.6185d8e1.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~c27f1b1d.eeaaa8c6.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~cdd1d9fd.b6dbaca7.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~0bcc290c.7cf29f1a.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~d6eb103f.a32d965a.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~5c078696.477401ce.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~f1a1cd68.6753eb79.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~defc7f12.ee85afea.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~54aeb72e.fa37be6c.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~d0ae3f07.8387c6b4.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~b5906859.6b900697.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~ec8c427e.e5ca240a.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~fdc6512a.146757e2.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~6a2c4da6.149ee583.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~205977d4.41d1d324.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/commons~7dcdd765.06c066b0.js" defer></script><script src="https://unpkg.com/jayconscious-blog@latest/docs/.vuepress/dist/assets/js/app.bde9cf47.js" defer></script>
  </body>
</html>
